{% extends "users/base.html" %}
{% block title %} Home Page {% endblock title%}
{% load static %}

{% block navbar %}
{% include 'users/navbar.html' %}
{% endblock navbar %}

{% block content %}

<!--====== SEARCH BOX PART START ======-->
<div class="search-box">
    <div class="serach-form">
        <div class="closebtn">
            <span></span>
            <span></span>
        </div>
        <form action="#">
            <input type="text" class="form-control" placeholder="Search by keyword">
            <button class="btn btn-primary"><i class="fa fa-search"></i></button>
        </form>
    </div>
</div>
<!--====== SEARCH BOX PART ENDS ======-->

<!--====== PAGE BANNER PART START ======-->
<section id="page-banner" class="pt-105 pb-110 bg-cover text-white" data-overlay="5" style="background-image: url('{% static 'images/page-banner-2.jpg' %}');">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="page-banner-cont">
                    <h2>{{ course_info.title }}</h2>
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="/" class="text-white">Home</a></li>
                            <li class="breadcrumb-item"><a href="/courses/courses" class="text-white">Courses</a></li>
                            <li class="breadcrumb-item active" aria-current="page">{{ course.title }}</li>
                        </ol>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</section>
<!--====== PAGE BANNER PART ENDS ======-->

<!--====== COURSES SINGLE PART START ======-->
<section id="courses-single" class="pt-90 pb-120 gray-bg">
    <div class="container">
        <div class="row">
            <!-- Main Content -->
            <div class="col-lg-8">
                <div class="course-single-left mt-30">
                    <div class="title">
                        <h3>{{ course.title }}</h3>
                    </div>

                    <!-- Course Terms -->
                    <div class="course-terms">
                        <ul class="list-unstyled">
                            <li class="mt-3">
                                <div class="teacher-name d-flex align-items-center">
                                    <div class="thum mr-3">
                                        <a href="#">
                                            <img src="{{ course.profile_teacher.image.url }}" alt="Profile picture of the teacher" class="rounded-circle" style="width: 50px; height: 50px;">
                                        </a>
                                    </div>
                                    <div class="name">
                                        <span class="text-muted">Teacher</span>
                                        <h6>{{ course.profile_teacher.user.first_name }} {{ course.profile_teacher.user.last_name }}</h6>
                                    </div>
                                </div>
                            </li>
                            <li class="mt-3">
                                <div class="course-category">
                                    <span class="text-muted">Category</span>
                                    <h6>{{ course.category }}</h6>
                                </div>
                            </li>
                            <li class="mt-3">
                                <div class="review">
                                    <span class="text-muted">Review</span>
                                    <ul class="list-inline">
                                        {% if course.reviews.all.count == 0 %}
                                            <li><a href="#" class="text-primary">Add a review</a></li>
                                        {% else %}
                                            <li class="list-inline-item">{{ average_rating }}</li>
                                            <li class="list-inline-item"><i class="fa fa-star text-warning"></i></li>
                                        {% endif %}
                                    </ul>
                                </div>
                            </li>
                        </ul>
                    </div>

                    <!-- Course Image -->
                    <div class="course-single-image pt-5">
                        <img src="{{ course.image.url }}" alt="Courses" class="img-fluid rounded">
                    </div>

                    <!-- Tabs -->
                    <div class="courses-tab mt-4">
                        <ul class="nav nav-tabs" id="myTab" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link active" id="overview-tab" data-toggle="tab" href="#overview" role="tab" aria-controls="overview" aria-selected="true">Overview</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="curriculam-tab" data-toggle="tab" href="#curriculam" role="tab" aria-controls="curriculam" aria-selected="false">Curriculum</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="instructor-tab" data-toggle="tab" href="#instructor" role="tab" aria-controls="instructor" aria-selected="false">Instructor</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="reviews-tab" data-toggle="tab" href="#reviews" role="tab" aria-controls="reviews" aria-selected="false">Reviews</a>
                            </li>
                        </ul>

                        <div class="tab-content mt-4" id="myTabContent">
                            <!-- Overview -->
                            <div class="tab-pane fade show active" id="overview" role="tabpanel" aria-labelledby="overview-tab">
                                <h6 class="pt-4">Course Summary</h6>
                                <p>{{ course.description }}</p>
                            </div>

                            <!-- Curriculum -->
                            <div class="tab-pane fade" id="curriculam" role="tabpanel" aria-labelledby="curriculam-tab">
                                {% for module in course.modules.all %}
                                    <h6 class="mt-4">{{ forloop.counter }}. {{ module.title }}</h6>
                                    <div class="accordion" id="accordionModule{{ forloop.counter }}">
                                        {% for lesson in module.lessons.all %}
                                            <div class="card">
                                                <div class="card-header" id="headingLesson{{ forloop.counter }}">
                                                    <h5 class="mb-0">
                                                        <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseLesson{{ forloop.counter }}" aria-expanded="false" aria-controls="collapseLesson{{ forloop.counter }}">
                                                            Lecture {{ forloop.counter }}: {{ lesson.name }}
                                                        </button>
                                                    </h5>
                                                </div>
                                                <div id="collapseLesson{{ forloop.counter }}" class="collapse" aria-labelledby="headingLesson{{ forloop.counter }}" data-parent="#accordionModule{{ forloop.parentloop.counter }}">
                                                    <div class="card-body">
                                                        {{ lesson.description }}
                                                    </div>
                                                </div>
                                            </div>
                                        {% endfor %}
                                    </div>
                                {% endfor %}
                            </div>

                            <!-- Instructor -->
                            <div class="tab-pane fade" id="instructor" role="tabpanel" aria-labelledby="instructor-tab">
                                <div class="d-flex align-items-center">
                                    <img src="{{ course.profile_teacher.image.url }}" alt="Instructor" class="rounded-circle mr-3" style="width: 80px; height: 80px;">
                                    <div>
                                        <h5>{{ course.profile_teacher.user.first_name }} {{ course.profile_teacher.user.last_name }}</h5>
                                        <p>{{ course.profile_teacher.bio }}</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Reviews -->
                            <div class="tab-pane fade" id="reviews" role="tabpanel" aria-labelledby="reviews-tab">
                                <h6>Student Reviews</h6>
                                <ul class="list-unstyled">
                                    {% for review in course.reviews.all %}
                                        <li class="mt-3">
                                            <div class="d-flex">
                                                <img src="{{ review.user.profile_cv.image.url|default:'media/default.jpg' }}" alt="Review Author" class="rounded-circle mr-3" style="width: 50px; height: 50px;">
                                                <div>
                                                    <h6>{{ review.user.first_name }} {{ review.user.last_name }}</h6>
                                                    <p>{{ review.comment }}</p>
                                                </div>
                                            </div>
                                        </li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="col-lg-4">
                <div class="course-features mt-30">
                    <h4>Course Features</h4>
                    <ul>
                        <li><i class="fa fa-clock-o"></i> Duration: <span>{{ formatted_duration }}</span></li>
                        <li><i class="fa fa-clone"></i> Lessons: <span>{{ total_lessons }}</span></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock content %}
